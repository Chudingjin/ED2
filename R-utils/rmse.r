#==========================================================================================#
#==========================================================================================#
#     Generic RMSE.                                                                        #
#------------------------------------------------------------------------------------------#
rmse.gen <<- function(yobs,yhat,np,na.rm=TRUE,unitless=TRUE){

   #------ Discard data in case na.rm = TRUE. ---------------------------------------------#
   if (na.rm){
      keep = is.finite(yobs) & is.finite(yhat)
      yobs = yobs[keep]
      yhat = yhat[keep]
   }#end if (na.rm)
   yres = yobs - yhat
   #---------------------------------------------------------------------------------------#



   #---------------------------------------------------------------------------------------#
   #     In case length is less than or equal to np, return NA.                            #
   #---------------------------------------------------------------------------------------#
   ny = length(yobs)
   if (ny <= (np+1)){
      ans = NA
      return(ans)
   }#end if
   #---------------------------------------------------------------------------------------#


   #---------------------------------------------------------------------------------------#
   #      Get the number of degrees of freedom, sum of squares, and root mean square       #
   # error.                                                                                #
   #---------------------------------------------------------------------------------------#
   df.tot   = ny - 1
   df.exp   = ny - np - 1
   ssq.res  = var(yres) * df.tot / df.exp
   mse      = ssq.res / df.exp
   
   if (unitless){
      ans   = sqrt(mse) / sd(yobs)
   }else{
      ans   = sqrt(mse)
   }#end if
   #---------------------------------------------------------------------------------------#

   return(ans)
}#end rmse.gen
#==========================================================================================#
#==========================================================================================#
